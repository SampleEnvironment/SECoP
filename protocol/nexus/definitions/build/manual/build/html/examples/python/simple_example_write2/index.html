


<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Write a NeXus HDF5 file with plottable data &#8212; nexus v2024.02 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinxdoc.css?v=87629129" />
    <link rel="stylesheet" type="text/css" href="../../../_static/details_summary_hide.css?v=30df4bca" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" href="../../../_static/blockquote.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/rubric.css" type="text/css" />
    <script src="../../../_static/documentation_options.js?v=04096e4a"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/tabs.js?v=3030b3cb"></script>
    <link rel="icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
    <link rel="next" title="Write a NeXuS HDF5 File with links to external data" href="../external_example_write/index.html" />
    <link rel="prev" title="Write a NeXus HDF5 file" href="../simple_example_write1/index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../external_example_write/index.html" title="Write a NeXuS HDF5 File with links to external data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../simple_example_write1/index.html" title="Write a NeXus HDF5 file"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">nexus v2024.02 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" ><span class="section-number">2. </span>Examples of writing and reading NeXus data files</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U"><span class="section-number">2.1.2. </span>HDF5 in Python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Write a NeXus HDF5 file with plottable data</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="write-a-nexus-hdf5-file-with-plottable-data">
<span id="example-simple-example-write2"></span><h1>Write a NeXus HDF5 file with plottable data<a class="headerlink" href="#write-a-nexus-hdf5-file-with-plottable-data" title="Link to this heading">¶</a></h1>
<p>Building on the previous example, we wish to identify our measured data with
the detector on the instrument where it was generated.
In this hypothetical case, since the detector was positioned at some
angle <em>two_theta</em>, we choose to store both datasets,
<code class="docutils literal notranslate"><span class="pre">two_theta</span></code> and <code class="docutils literal notranslate"><span class="pre">counts</span></code>, in a NeXus group.
One appropriate NeXus group is <a class="reference internal" href="../../../classes/base_classes/NXdetector.html#nxdetector"><span class="std std-ref">NXdetector</span></a>.
This group is placed in a <a class="reference internal" href="../../../classes/base_classes/NXinstrument.html#nxinstrument"><span class="std std-ref">NXinstrument</span></a> group
which is placed in a <a class="reference internal" href="../../../classes/base_classes/NXentry.html#nxentry"><span class="std std-ref">NXentry</span></a> group.
To support a default plot, we provide a <a class="reference internal" href="../../../classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a> group.
Rather than duplicate the same data already placed in the detector group,
we choose to link to those datasets from the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group.
(Compare the next figure with <a class="reference internal" href="../../../design.html#fig-data-linking"><span class="std std-ref">Linking in a NeXus file</span></a> in the
<a class="reference internal" href="../../../design.html#design"><span class="std std-ref">NeXus Design</span></a> chapter of the NeXus User Manual.)
The <a class="reference internal" href="../../../design.html#design"><span class="std std-ref">NeXus Design</span></a> chapter provides a figure
(<a class="reference internal" href="../../../design.html#fig-data-linking"><span class="std std-ref">Linking in a NeXus file</span></a>) with a small variation from our
previous example, placing the measured data
within the <code class="docutils literal notranslate"><span class="pre">/entry/instrument/detector</span></code> group.
Links are made from that data to the <code class="docutils literal notranslate"><span class="pre">/entry/data</span></code> group.</p>
<div class="compound">
<figure class="align-default" id="id1">
<span id="fig-simple-example-write2"></span><a class="reference internal image-reference" href="../../../_images/simple_example_write2.png"><img alt="fig.simple_example_write2" src="../../../_images/simple_example_write2.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text">h5py example showing linking in a NeXus file</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
<p>The Python code to build an HDF5 data file with that structure (using
numerical data from the previous example) is shown below.</p>
<blockquote>
<div><div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">nexusformat</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">h5py</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#!/usr/bin/env python</span>
<span class="linenos"> 2</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 3</span><span class="sd">Writes a simple NeXus HDF5 file using h5py with links</span>
<span class="linenos"> 4</span><span class="sd">according to the example from Figure 2.1 in the Design chapter</span>
<span class="linenos"> 5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="kn">from</span> <span class="nn">nexusformat.nexus</span> <span class="kn">import</span> <span class="p">(</span><span class="n">NXdata</span><span class="p">,</span> <span class="n">NXdetector</span><span class="p">,</span> <span class="n">NXentry</span><span class="p">,</span> <span class="n">NXfield</span><span class="p">,</span>
<span class="linenos">12</span>                               <span class="n">NXinstrument</span><span class="p">,</span> <span class="n">NXlink</span><span class="p">,</span> <span class="n">nxopen</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;simple_example.dat&quot;</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="linenos">16</span><span class="n">tthData</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># float[]</span>
<span class="linenos">17</span><span class="n">countsData</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;int32&quot;</span><span class="p">)</span>  <span class="c1"># int[]</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="k">with</span> <span class="n">nxopen</span><span class="p">(</span><span class="s2">&quot;simple_example_write2.hdf5&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># create the HDF5 NeXus file</span>
<span class="linenos">20</span>    <span class="n">f</span><span class="p">[</span><span class="s2">&quot;entry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NXentry</span><span class="p">()</span>
<span class="linenos">21</span>    <span class="n">f</span><span class="p">[</span><span class="s2">&quot;entry/instrument&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NXinstrument</span><span class="p">()</span>
<span class="linenos">22</span>    <span class="n">f</span><span class="p">[</span><span class="s2">&quot;entry/instrument/detector&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NXdetector</span><span class="p">()</span>
<span class="linenos">23</span>
<span class="linenos">24</span>    <span class="c1"># store the data in the NXdetector group</span>
<span class="linenos">25</span>    <span class="n">f</span><span class="p">[</span><span class="s2">&quot;entry/instrument/detector/two_theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NXfield</span><span class="p">(</span><span class="n">tthData</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;degrees&quot;</span><span class="p">)</span>
<span class="linenos">26</span>    <span class="n">f</span><span class="p">[</span><span class="s2">&quot;entry/instrument/detector/counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NXfield</span><span class="p">(</span><span class="n">countsData</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;counts&quot;</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span>    <span class="n">f</span><span class="p">[</span><span class="s2">&quot;entry/data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NXdata</span><span class="p">(</span><span class="n">NXlink</span><span class="p">(</span><span class="s2">&quot;/entry/instrument/detector/counts&quot;</span><span class="p">),</span>
<span class="linenos">29</span>                             <span class="n">NXlink</span><span class="p">(</span><span class="s2">&quot;/entry/instrument/detector/two_theta&quot;</span><span class="p">))</span>
<span class="linenos">30</span>    <span class="n">f</span><span class="p">[</span><span class="s2">&quot;entry/data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_default</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#!/usr/bin/env python</span>
<span class="linenos"> 2</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 3</span><span class="sd">Writes a simple NeXus HDF5 file using h5py with links</span>
<span class="linenos"> 4</span><span class="sd">according to the example from Figure 2.1 in the Design chapter</span>
<span class="linenos"> 5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="linenos"> 8</span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="linenos"> 9</span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;simple_example.dat&quot;</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="linenos">13</span><span class="n">tthData</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># float[]</span>
<span class="linenos">14</span><span class="n">countsData</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;int32&quot;</span><span class="p">)</span>  <span class="c1"># int[]</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s2">&quot;simple_example_write2.hdf5&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># create the HDF5 NeXus file</span>
<span class="linenos">17</span>    <span class="n">f</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;entry&quot;</span>
<span class="linenos">18</span>
<span class="linenos">19</span>    <span class="n">nxentry</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">)</span>
<span class="linenos">20</span>    <span class="n">nxentry</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;NX_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NXentry&quot;</span>
<span class="linenos">21</span>    <span class="n">nxentry</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;data&quot;</span>
<span class="linenos">22</span>
<span class="linenos">23</span>    <span class="n">nxinstrument</span> <span class="o">=</span> <span class="n">nxentry</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s2">&quot;instrument&quot;</span><span class="p">)</span>
<span class="linenos">24</span>    <span class="n">nxinstrument</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;NX_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NXinstrument&quot;</span>
<span class="linenos">25</span>
<span class="linenos">26</span>    <span class="n">nxdetector</span> <span class="o">=</span> <span class="n">nxinstrument</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s2">&quot;detector&quot;</span><span class="p">)</span>
<span class="linenos">27</span>    <span class="n">nxdetector</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;NX_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NXdetector&quot;</span>
<span class="linenos">28</span>
<span class="linenos">29</span>    <span class="c1"># store the data in the NXdetector group</span>
<span class="linenos">30</span>    <span class="n">ds_tth</span> <span class="o">=</span> <span class="n">nxdetector</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s2">&quot;two_theta&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tthData</span><span class="p">)</span>
<span class="linenos">31</span>    <span class="n">ds_tth</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;degrees&quot;</span>
<span class="linenos">32</span>    <span class="n">ds_counts</span> <span class="o">=</span> <span class="n">nxdetector</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s2">&quot;counts&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">countsData</span><span class="p">)</span>
<span class="linenos">33</span>    <span class="n">ds_counts</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;counts&quot;</span>
<span class="linenos">34</span>
<span class="linenos">35</span>    <span class="c1"># create the NXdata group to define the default plot</span>
<span class="linenos">36</span>    <span class="n">nxdata</span> <span class="o">=</span> <span class="n">nxentry</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="linenos">37</span>    <span class="n">nxdata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;NX_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NXdata&quot;</span>
<span class="linenos">38</span>    <span class="n">nxdata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;counts&quot;</span>
<span class="linenos">39</span>    <span class="n">nxdata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;two_theta&quot;</span>
<span class="linenos">40</span>    <span class="n">nxdata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;two_theta_indices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">41</span>        <span class="mi">0</span><span class="p">,</span>
<span class="linenos">42</span>    <span class="p">]</span>
<span class="linenos">43</span>
<span class="linenos">44</span>    <span class="n">source_addr</span> <span class="o">=</span> <span class="s2">&quot;/entry/instrument/detector/two_theta&quot;</span>  <span class="c1"># existing data</span>
<span class="linenos">45</span>    <span class="n">target_addr</span> <span class="o">=</span> <span class="s2">&quot;two_theta&quot;</span>  <span class="c1"># new location</span>
<span class="linenos">46</span>    <span class="n">ds_tth</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_addr</span>  <span class="c1"># a NeXus API convention for links</span>
<span class="linenos">47</span>    <span class="n">nxdata</span><span class="p">[</span><span class="n">target_addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">source_addr</span><span class="p">]</span>  <span class="c1"># hard link</span>
<span class="linenos">48</span>    <span class="c1"># nxdata._id.link(source_addr, target_addr, h5py.h5g.LINK_HARD)</span>
<span class="linenos">49</span>
<span class="linenos">50</span>    <span class="n">source_addr</span> <span class="o">=</span> <span class="s2">&quot;/entry/instrument/detector/counts&quot;</span>  <span class="c1"># existing data</span>
<span class="linenos">51</span>    <span class="n">target_addr</span> <span class="o">=</span> <span class="s2">&quot;counts&quot;</span>  <span class="c1"># new location</span>
<span class="linenos">52</span>    <span class="n">ds_counts</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_addr</span>  <span class="c1"># a NeXus API convention for links</span>
<span class="linenos">53</span>    <span class="n">nxdata</span><span class="p">[</span><span class="n">target_addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">source_addr</span><span class="p">]</span>  <span class="c1"># hard link</span>
<span class="linenos">54</span>    <span class="c1"># nxdata._id.link(source_addr, target_addr, h5py.h5g.LINK_HARD)</span>
</pre></div>
</div>
</div></div>
</div></blockquote>
<p>It is interesting to compare the output of the <code class="docutils literal notranslate"><span class="pre">h5dump</span></code>
of the data file <code class="docutils literal notranslate"><span class="pre">simple_example_write2.hdf5</span></code> with our Python instructions.
See the <em>downloads</em> section below.</p>
<p>Look carefully!  It <em>appears</em> in the output of
<code class="docutils literal notranslate"><span class="pre">h5dump</span></code> that the actual data for <code class="docutils literal notranslate"><span class="pre">two_theta</span></code>
and <code class="docutils literal notranslate"><span class="pre">counts</span></code> has <em>moved</em> into
the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group at HDF5 path <code class="docutils literal notranslate"><span class="pre">/entry/data</span></code>!  But we stored
that data in the <code class="docutils literal notranslate"><span class="pre">NXdetector</span></code> group at <code class="docutils literal notranslate"><span class="pre">/entry/instrument/detector</span></code>.
This is normal for <code class="docutils literal notranslate"><span class="pre">h5dump</span></code> output.</p>
<p>A bit of explanation is necessary at this point.
The data is not stored in either HDF5 group directly.  Instead, HDF5
creates a <code class="docutils literal notranslate"><span class="pre">DATA</span></code> storage element in the file and posts a reference
to that <code class="docutils literal notranslate"><span class="pre">DATA</span></code> storage element as needed.
An HDF5 <em>hard link</em>
requests another reference to that same <code class="docutils literal notranslate"><span class="pre">DATA</span></code> storage element.
The <code class="docutils literal notranslate"><span class="pre">h5dump</span></code> tool describes in full that <code class="docutils literal notranslate"><span class="pre">DATA</span></code> storage element
the first time (alphabetically) it is called.  In our case, that is within the
<code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group.  The next time it is called, within the
<code class="docutils literal notranslate"><span class="pre">NXdetector</span></code> group, <code class="docutils literal notranslate"><span class="pre">h5dump</span></code> reports that a hard link
has been made and shows the HDF5 path to the description.</p>
<p>NeXus recognizes this behavior of the HDF5 library and adds an additional structure
when building hard links, the <code class="docutils literal notranslate"><span class="pre">target</span></code> attribute,
to preserve the original location of the data.  Not that it actually matters.
the <a class="reference internal" href="../../../validation.html#punx"><span class="std std-ref">punx tree</span></a> tool knows about the additional NeXus
<code class="docutils literal notranslate"><span class="pre">target</span></code> attribute and shows the data to appear in its original
location, in the <code class="docutils literal notranslate"><span class="pre">NXdetector</span></code> group.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>  @default = &quot;entry&quot;
<span class="linenos"> 2</span>  entry:NXentry
<span class="linenos"> 3</span>    @NX_class = &quot;NXentry&quot;
<span class="linenos"> 4</span>    @default = &quot;data&quot;
<span class="linenos"> 5</span>    data:NXdata
<span class="linenos"> 6</span>      @NX_class = &quot;NXdata&quot;
<span class="linenos"> 7</span>      @axes = &quot;two_theta&quot;
<span class="linenos"> 8</span>      @signal = &quot;counts&quot;
<span class="linenos"> 9</span>      @two_theta_indices = [0]
<span class="linenos">10</span>      counts --&gt; /entry/instrument/detector/counts
<span class="linenos">11</span>      two_theta --&gt; /entry/instrument/detector/two_theta
<span class="linenos">12</span>    instrument:NXinstrument
<span class="linenos">13</span>      @NX_class = &quot;NXinstrument&quot;
<span class="linenos">14</span>      detector:NXdetector
<span class="linenos">15</span>        @NX_class = &quot;NXdetector&quot;
<span class="linenos">16</span>        counts:NX_INT32[31] = [1037, 1318, 1704, &#39;...&#39;, 1321]
<span class="linenos">17</span>          @target = &quot;/entry/instrument/detector/counts&quot;
<span class="linenos">18</span>          @units = &quot;counts&quot;
<span class="linenos">19</span>        two_theta:NX_FLOAT64[31] = [17.92608, 17.92591, 17.92575, &#39;...&#39;, 17.92108]
<span class="linenos">20</span>          @target = &quot;/entry/instrument/detector/two_theta&quot;
<span class="linenos">21</span>          @units = &quot;degrees&quot;
</pre></div>
</div>
<section id="downloads">
<h2>downloads<a class="headerlink" href="#downloads" title="Link to this heading">¶</a></h2>
<p>The Python code and files related to this section may be downloaded from the following table.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>file</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference download internal" download="" href="../../../_downloads/7c1e66cc3d34663e3384e0c1e1389e8d/simple_example.dat"><code class="xref download docutils literal notranslate"><span class="pre">../simple_example.dat</span></code></a></p></td>
<td><p>2-column ASCII data used in this section</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference download internal" download="" href="../../../_downloads/3b7dde73e3bfd8b7c7fe8278259ef911/simple_example_write2.py"><code class="xref download docutils literal notranslate"><span class="pre">simple_example_write2.py</span></code></a></p></td>
<td><p>h5py code to write example <em>simple_example_write2</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference download internal" download="" href="../../../_downloads/cbbd968592fa4309c4c43ecd8dd24180/simple_example_write2.py"><code class="xref download docutils literal notranslate"><span class="pre">nexusformat/simple_example_write2.py</span></code></a></p></td>
<td><p>nexusformat code to write example <em>simple_example_write2</em></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference download internal" download="" href="../../../_downloads/b0ec75cd5c968310ab4f0a18b96ac858/simple_example_write2.hdf5"><code class="xref download docutils literal notranslate"><span class="pre">simple_example_write2.hdf5</span></code></a></p></td>
<td><p>NeXus file written by this code</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference download internal" download="" href="../../../_downloads/5def07379b71ffd9d471f77fcbdecb44/simple_example_write2_h5dump.txt"><code class="xref download docutils literal notranslate"><span class="pre">simple_example_write2_h5dump.txt</span></code></a></p></td>
<td><p><em>h5dump</em> analysis of the NeXus file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference download internal" download="" href="../../../_downloads/83d452fa17ae809042c0979bf30361be/simple_example_write2_structure.txt"><code class="xref download docutils literal notranslate"><span class="pre">simple_example_write2_structure.txt</span></code></a></p></td>
<td><p><em>punx tree</em> analysis of the NeXus file</p></td>
</tr>
</tbody>
</table>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Write a NeXus HDF5 file with plottable data</a><ul>
<li><a class="reference internal" href="#downloads">downloads</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../simple_example_write1/index.html"
                          title="previous chapter">Write a NeXus HDF5 file</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../external_example_write/index.html"
                          title="next chapter">Write a NeXuS HDF5 File with links to external data</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <p>Have a Question? <a href="https://github.com/nexusformat/definitions/issues/new">Get help</a></p>
    <ul class="this-page-menu">
    <style>
		  .avatar-container {
		    display: flex;
		    align-items: center;
		  }
		
		  .avatar {
		    width: 32px;
		    height: 32px;
		    border-radius: 50%;
		    margin-right: 5px;
		  }
		</style>
		
    
    
		<div class="avatar-container">
      
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
<div id="google_search" style="display: none">
	<hr />
	<h3>Google search</h3>
	<form method="get" action="https://www.google.com/search">
		<table border="0" align="center" cellpadding="0">
			<tr>
				<td>
					<input type="text"   name="q" value="" />
				</td>
			</tr>
			<tr>
				<td align="center" style="font-size:75%">
					<input type="radio"  name="sitesearch" value="" />global
					<input type="radio"  name="sitesearch"
						value="manual.nexusformat.org" 
						checked />NeXus manual
					<input type="submit" value="Go" />
					<br />
				</td>
			</tr>
		</table>
	</form>                                
</div>
<script type="text/javascript">$('#google_search').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../external_example_write/index.html" title="Write a NeXuS HDF5 File with links to external data"
             >next</a> |</li>
        <li class="right" >
          <a href="../simple_example_write1/index.html" title="Write a NeXus HDF5 file"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">nexus v2024.02 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" ><span class="section-number">2. </span>Examples of writing and reading NeXus data files</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" ><span class="section-number">2.1.2. </span>HDF5 in Python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Write a NeXus HDF5 file with plottable data</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../../copyright.html">Copyright</a> 1996-2024, NIAC, https://www.nexusformat.org.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>