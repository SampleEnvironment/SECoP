


<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.3.2. Rules for Storing Data Items in NeXus Files &#8212; nexus v2024.02 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css?v=87629129" />
    <link rel="stylesheet" type="text/css" href="_static/details_summary_hide.css?v=30df4bca" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" href="_static/blockquote.css" type="text/css" />
    <link rel="stylesheet" href="_static/rubric.css" type="text/css" />
    <script src="_static/documentation_options.js?v=04096e4a"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="1.2.3.3. Physical File format" href="fileformat.html" />
    <link rel="prev" title="1.2.3.1. Rules for Structuring Information in NeXus Files" href="rules.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="fileformat.html" title="1.2.3.3. Physical File format"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rules.html" title="1.2.3.1. Rules for Structuring Information in NeXus Files"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">nexus v2024.02 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="user_manual.html" ><span class="section-number">1. </span>NeXus: User Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="design.html" accesskey="U"><span class="section-number">1.2. </span>NeXus Design</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1.2.3.2. </span>Rules for Storing Data Items in NeXus Files</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="rules-for-storing-data-items-in-nexus-files">
<span id="datarules"></span><h1><span class="section-number">1.2.3.2. </span>Rules for Storing Data Items in NeXus Files<a class="headerlink" href="#rules-for-storing-data-items-in-nexus-files" title="Link to this heading">¶</a></h1>
<p>This section describes the rules which apply for storing single data items.</p>
<section id="naming-conventions">
<span id="design-naming"></span><h2>Naming Conventions<a class="headerlink" href="#naming-conventions" title="Link to this heading">¶</a></h2>
<p id="index-0">Group and field names used within NeXus follow a naming convention
described by the following <span class="target" id="index-1"></span>rules:</p>
<ul>
<li><p>The names of NeXus <em>group</em> and <em>field</em> items
must only contain a restricted set of characters.</p>
<p>This set is described by a regular expression
syntax <span class="target" id="index-2"></span>regular expression
<a class="reference internal" href="#regexpname"><span class="std std-ref">regular expression syntax</span></a>,
as described below.</p>
</li>
<li><p>For the class names <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> of NeXus <em>group</em> items,
the prefix <em>NX</em> is reserved as shown in the <a class="reference internal" href="#reserved-prefixes"><span class="std std-ref">table</span></a> below.
Thus all NeXus class names start with NX.
The chapter titled <a class="reference internal" href="ref_doc.html#referencedocumentation"><span class="std std-ref">NeXus: Reference Documentation</span></a> lists the
available NeXus class names as either <em>base classes</em>,
<em>application definitions</em>, or <em>contributed definitions</em>.</p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>The <em>class name</em> is the value assigned to the
<em>NX_class</em> attribute of an HDF5 group in the NeXus data file.
This <em>class name</em> is different than the <em>name</em> of the HDF5 group.
This is important when not using the NAPI to either read or write
the HDF5 data file.</p>
</aside>
</aside>
<p class="rubric">NXDL group and field names</p>
<div class="compound">
<p>The names of NeXus <em>group</em> and <em>field</em> items
are validated according to these boundaries:</p>
<ul class="simple">
<li><p><em>Recommended</em> names <a class="footnote-reference brackets" href="#lc" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p>
<ul>
<li><p>lower case words separated by underscores and, if needed, with a trailing number</p></li>
<li><p>NOTE: this is used by the NeXus base classes</p></li>
</ul>
</li>
<li><p><em>Allowed</em> names</p>
<ul>
<li><p>any combination of upper and lower case letter, numbers, underscores and periods, except that periods cannot be at the start or end of the string</p></li>
<li><p>NOTE: this matches the <em>validItemName</em> regular expression <a class="reference internal" href="#validitemname"><span class="std std-ref">below</span></a></p></li>
</ul>
</li>
<li><p><em>Invalid</em> names</p>
<ul>
<li><p>NOTE: does not match the <em>validItemName</em> regular expression <a class="reference internal" href="#validitemname"><span class="std std-ref">below</span></a></p></li>
</ul>
</li>
</ul>
<p class="rubric" id="regexpname">Regular expression pattern for NXDL group and field names</p>
<p>The NIAC recognises that the majority of the world uses characters
outside of the basic latin (a.k.a. US-ASCII, 7-bit ASCII) set
currently included in the allowed names. The restriction given here
reflects current technical issues and we expect to revisit the issue
and relax such restrictions in future.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="bit-ascii" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/ASCII">https://en.wikipedia.org/wiki/ASCII</a></p>
</aside>
</aside>
<p>The names of NeXus <em>group</em> and <em>field</em> items must match
this regular expression (named <em>validItemName</em> in the
XML Schema file: <em>nxdl.xsd</em>):</p>
<div class="highlight-text notranslate" id="validitemname"><div class="highlight"><pre><span></span><span class="linenos">1</span>^[a-zA-Z0-9_]([a-zA-Z0-9_.]*[a-zA-Z0-9_])?$
</pre></div>
</div>
<p>The length should be limited to no more than
63 characters (imposed by the HDF5 <span class="target" id="index-3"></span>rules for names).</p>
<p>It is recognized that some facilities will construct data files with
group and field names with upper case letters or start names with a
number or include a period in a name. <a class="footnote-reference brackets" href="#lc" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="lc" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id3">1</a>,<a role="doc-backlink" href="#id4">2</a>)</span>
<p>NeXus data files with group or field names
that match the regular expression but contain upper case
characters, start with a digit, or include a period in the group
or field names might not be accepted by all software that reads
NeXus data files.  These names will be flagged as a warning during
data file validation.</p>
</aside>
</aside>
</div>
<p class="rubric" id="use-underscore">Use of underscore in descriptive names</p>
<p>Sometimes it is necessary to combine words in order to build a
descriptive name for a field or a group.
In such cases lowercase words are connected by underscores.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>number_of_lenses
</pre></div>
</div>
<p>For all fields, only names from the NeXus base class dictionaries should be used.
If a field name or even a complete component is missing,
please suggest the addition to the <a class="reference internal" href="niac.html#niac"><span class="std std-ref">NIAC: The NeXus International Advisory Committee</span></a>. The addition will usually be
accepted provided it is not a duplication of an existing field and
adequately documented.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The NeXus base classes provide a comprehensive dictionary of terms that can be used for each class.
The expected spelling and definition of each term is specified in the base classes.
It is not required to provide all the terms specified in a base class.
Terms with other names are permitted but might not be recognized by standard software.
Rather than persist in using names not specified in the standard, please suggest additions to the <a class="reference internal" href="niac.html#niac"><span class="std std-ref">NIAC: The NeXus International Advisory Committee</span></a>.</p>
</div>
</div></blockquote>
<p id="target-value">The data stored in NeXus fields must be <em>readback</em> values.
This means values as read from the detector, other hardware, etc.
There are occasions where it is sensible to store the target value
the variable was supposed to have. In such cases, the
<em>target</em> value is stored with a name built by appending
<code class="docutils literal notranslate"><span class="pre">_set</span></code> to the NeXus (readback) field name.</p>
<p>Consider this example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>temperature
<span class="linenos">2</span>temperature_set
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">temperature</span></code> field will hold the readback from the
cryostat/furnace/whatever. The field <code class="docutils literal notranslate"><span class="pre">temperature_set</span></code> will hold
the target value for the temperature as set by the
experiment control software.</p>
<p>Some fields share a common part of their name and an additional part
name that makes the whole name specific.  For example, a <code class="docutils literal notranslate"><span class="pre">unit_cell</span></code>
might have parts named <code class="docutils literal notranslate"><span class="pre">abc</span></code>, <code class="docutils literal notranslate"><span class="pre">alphabetagamma</span></code>, and <code class="docutils literal notranslate"><span class="pre">volume</span></code>.  It
is recommended to write them with the common part first, an underscore
(<code class="docutils literal notranslate"><span class="pre">_</span></code>), and then the specific part.  In this way, the fields will sort
alphabetically on the common name. So, in this example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>unit_cell_abc
<span class="linenos">2</span>unit_cell_alphabetagamma
<span class="linenos">3</span>unit_cell_volume
</pre></div>
</div>
<p class="rubric" id="reserved-prefixes"><span id="index-4"></span>Reserved prefixes</p>
<p>When naming an attribute, field, or group,
NeXus has reserved certain prefixes to the names to
ensure that names written in NeXus files will not conflict with future
releases as the NeXus standard evolves. Prefixes should follow a naming
scheme of uppercase letters followed by an underscore, but exceptions
will be made for cases already in wide use. The following table lists
the prefixes reserved by NeXus.</p>
<table class="docutils align-default" id="index-5">
<thead>
<tr class="row-odd"><th class="head"><p>prefix</p></th>
<th class="head"><p>use</p></th>
<th class="head"><p>meaning</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BLUESKY_</span></code></p></td>
<td><p>attributes</p></td>
<td><p>reserved for use by Bluesky project</p></td>
<td><p><a class="reference external" href="https://blueskyproject.io">https://blueskyproject.io</a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DECTRIS_</span></code></p></td>
<td><p>attributes, fields</p></td>
<td><p>reserved for use by Dectris</p></td>
<td><p><a class="reference external" href="https://www.dectris.com">https://www.dectris.com</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IDF_</span></code></p></td>
<td><p>attributes</p></td>
<td><p>reserved for use by pulsedTD Muon definition</p></td>
<td><p><a class="reference external" href="https://www.isis.stfc.ac.uk/Pages/nexus-definition-v27924.pdf">https://www.isis.stfc.ac.uk/Pages/nexus-definition-v27924.pdf</a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NDAttr</span></code></p></td>
<td><p>attributes</p></td>
<td><p>reserved for use by EPICS area detector</p></td>
<td><p><a class="reference external" href="https://github.com/areaDetector">https://github.com/areaDetector</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NX</span></code></p></td>
<td><p>NXDL class</p></td>
<td><p>for the class names used with NeXus groups</p></td>
<td><p><a class="reference external" href="https://www.nexusformat.org">https://www.nexusformat.org</a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NX_</span></code></p></td>
<td><p>attributes</p></td>
<td><p>reserved for use by NeXus</p></td>
<td><p><a class="reference external" href="https://www.nexusformat.org">https://www.nexusformat.org</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PDBX_</span></code></p></td>
<td><p>attributes</p></td>
<td><p>reserved for the US protein data bank</p></td>
<td><p><a class="reference external" href="https://www.rcsb.org">https://www.rcsb.org</a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SAS_</span></code></p></td>
<td><p>attributes</p></td>
<td><p>reserved for use by canSAS</p></td>
<td><p><a class="reference external" href="https://www.cansas.org">https://www.cansas.org</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SILX_</span></code></p></td>
<td><p>attributes</p></td>
<td><p>reserved for use by silx</p></td>
<td><p><a class="reference external" href="https://www.silx.org">https://www.silx.org</a></p></td>
</tr>
</tbody>
</table>
<p class="rubric" id="reserved-suffixes"><span id="index-6"></span>Reserved suffixes</p>
<p>When naming a field, NeXus has reserved certain suffixes to the names
so that a specific meaning may be attached.  Consider a field named <code class="docutils literal notranslate"><span class="pre">DATASET</span></code>,
the following table lists the suffixes reserved by NeXus.</p>
<table class="docutils align-default" id="index-7">
<thead>
<tr class="row-odd"><th class="head"><p>suffix</p></th>
<th class="head"><p>reference</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">_end</span></code></p></td>
<td><p><a class="reference internal" href="classes/base_classes/NXtransformations.html#nxtransformations"><span class="std std-ref">NXtransformations</span></a></p></td>
<td><p>end points of the motions that start with <code class="docutils literal notranslate"><span class="pre">DATASET</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">_errors</span></code></p></td>
<td><p><a class="reference internal" href="classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a></p></td>
<td><p>uncertainties (a.k.a., errors)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">_increment_set</span></code></p></td>
<td><p><a class="reference internal" href="classes/base_classes/NXtransformations.html#nxtransformations"><span class="std std-ref">NXtransformations</span></a></p></td>
<td><p>intended average range through which the corresponding axis moves during the exposure of a frame</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">_indices</span></code></p></td>
<td><p><a class="reference internal" href="classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a></p></td>
<td><p>Integer array that defines the indices of the signal field which need to be used in the <code class="docutils literal notranslate"><span class="pre">DATASET</span></code> in order to reference the corresponding axis value</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">_mask</span></code></p></td>
<td></td>
<td><p>Field containing a signal mask, where 0 means the pixel is not masked. If required, bit masks are defined in <a class="reference internal" href="classes/base_classes/NXdetector.html#nxdetector"><span class="std std-ref">NXdetector</span></a> <code class="docutils literal notranslate"><span class="pre">pixel_mask</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">_set</span></code></p></td>
<td><p><a class="reference internal" href="#target-value"><span class="std std-ref">target values</span></a></p></td>
<td><p>Target value of <code class="docutils literal notranslate"><span class="pre">DATASET</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">_weights</span></code></p></td>
<td></td>
<td><p>divide <code class="docutils literal notranslate"><span class="pre">DATASET</span></code> by these weights <a class="footnote-reference brackets" href="#id6" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a></p></td>
</tr>
</tbody>
</table>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">4</a><span class="fn-bracket">]</span></span>
<p>If <code class="docutils literal notranslate"><span class="pre">DATASET_weights</span></code> exists and has the same shape as the field,
you are supposed to divide <code class="docutils literal notranslate"><span class="pre">DATASET</span></code> by the weights.</p>
</aside>
</aside>
</section>
<section id="variants">
<span id="design-variants"></span><h2>Variants<a class="headerlink" href="#variants" title="Link to this heading">¶</a></h2>
<p>Sometimes it is necessary to store alternate values of a NeXus field
in a NeXus file. A common example may be the beam center of which a
rough value is available at data acquisition. But later on, a better beam
center is calculated as part of the data reduction. In order to store
this without losing the historical information, the original field can be given a variant attribute that points to
a new field containing the obsolete value. If even better values
become available, further fields can be inserted into the chain of variant attributes
pointing to the preceeding value for the field. A reader can thus
keep the best value in the pre-defined field, and also be able to
follow the variant chain and locate older variants.</p>
<p>A little example is in order to illustrate the scheme:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>beam_center_x
<span class="linenos">2</span>        @variant=beam_center_x_refined
<span class="linenos">3</span>beam_center_x_refined
<span class="linenos">4</span>        @variant=beam_center_x_initial_guess
<span class="linenos">5</span>beam_center_x_initial_guess
</pre></div>
</div>
<p>NeXus borrowed this scheme from CIF. In this way all the different
variants of a field can be preserved. The expectation is that
variants will be rarely used and NXprocess groups with the results of
data reduction will be written instead.</p>
</section>
<section id="uncertainties-or-errors">
<span id="design-uncertainties"></span><h2>Uncertainties or Errors<a class="headerlink" href="#uncertainties-or-errors" title="Link to this heading">¶</a></h2>
<p>It is desirable to store experimental errors (also known as
<em>uncertainties</em>) together with the data. NeXus supports this through
a convention: uncertainties or experimental errors on data are
stored in a separate field which has a name consisting of the
original name of the data with <code class="docutils literal notranslate"><span class="pre">_errors</span></code> appended to it.
These uncertainties fields have the same shape as the original data field.</p>
<p>An example, from NXdetector:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>data
<span class="linenos">2</span>data_errors
<span class="linenos">3</span>beam_center_x
<span class="linenos">4</span>beam_center_x_errors
</pre></div>
</div>
<p>Where data errors would contain the errors on data, and beam_center_x_errors the error on
the beam center for x.</p>
</section>
<section id="nexus-array-storage-order">
<span id="design-arraystorageorder"></span><h2>NeXus Array Storage Order<a class="headerlink" href="#nexus-array-storage-order" title="Link to this heading">¶</a></h2>
<p>NeXus stores <span class="target" id="index-8"></span>multi-dimensional
arrays of physical values in C language storage order,
where the first dimension has the <span class="target" id="index-9"></span>slowest varying index when iterating through the array in storage order,
and the last dimension is the <span class="target" id="index-10"></span>fastest varying. This is the rule.
<em>Good reasons are required to deviate from this rule.</em></p>
<p>Where the array contains data from a detector, the array dimensions may correspond to physical directions or axes. The slowest, slow, fast, fastest qualifiers can then apply to these axes too.</p>
<p>It is possible to store data in storage orders other than C language order.</p>
<p>As well it is possible to specify that the data needs to be converted first
before being useful.  Consider one situation, when data must be
streamed to disk as fast as possible and conversion to C language
storage order causes unnecessary latency.  This case presents a
good reason to make an exception to the standard rule.</p>
<section id="non-c-storage-order">
<span id="design-noncstorageorder"></span><span id="index-11"></span><h3>Non C Storage Order<a class="headerlink" href="#non-c-storage-order" title="Link to this heading">¶</a></h3>
<p>In order to indicate that the storage order is different from C storage order two
additional data set attributes, offset and stride, have to be stored which together define the storage
layout of the data. Offset and stride contain rank numbers according to the rank of the multidimensional
data set. Offset describes the step to make when the dimension is multiplied by 1. Stride defines the step to
make when incrementing the dimension. This is best explained by some examples.</p>
<div class="compound">
<p class="rubric">Offset and Stride for 1 D data:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>   * raw data = 0 1 2 3 4 5 6 7 8 9
<span class="linenos"> 2</span>      size[1] = { 10 }  // assume uniform overall array dimensions
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>   * default stride:
<span class="linenos"> 5</span>      stride[1] = { 1 }
<span class="linenos"> 6</span>      offset[1] = { 0 }
<span class="linenos"> 7</span>      for i:
<span class="linenos"> 8</span>         result[i]:
<span class="linenos"> 9</span>            0 1 2 3 4 5 6 7 8 9
<span class="linenos">10</span>
<span class="linenos">11</span>   * reverse stride:
<span class="linenos">12</span>      stride[1] = { -1 }
<span class="linenos">13</span>      offset[1] = { 9 }
<span class="linenos">14</span>      for i:
<span class="linenos">15</span>         result[i]:
<span class="linenos">16</span>            9 8 7 6 5 4 3 2 1 0
</pre></div>
</div>
</div>
<div class="compound">
<p class="rubric">Offset and Stride for 2D Data</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>   * raw data = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
<span class="linenos"> 2</span>      size[2] = { 4, 5 }  // assume uniform overall array dimensions
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>   * row major (C) stride:
<span class="linenos"> 5</span>      stride[2] = { 5, 1 }
<span class="linenos"> 6</span>      offset[2] = { 0, 0 }
<span class="linenos"> 7</span>      for i:
<span class="linenos"> 8</span>         for j:
<span class="linenos"> 9</span>            result[i][j]:
<span class="linenos">10</span>               0 1 2 3 4
<span class="linenos">11</span>               5 6 7 8 9
<span class="linenos">12</span>               10 11 12 13 14
<span class="linenos">13</span>               15 16 17 18 19
<span class="linenos">14</span>
<span class="linenos">15</span>   * column major (Fortran) stride:
<span class="linenos">16</span>      stride[2] = { 1, 4 }
<span class="linenos">17</span>      offset[2] = { 0, 0 }
<span class="linenos">18</span>      for i:
<span class="linenos">19</span>         for j:
<span class="linenos">20</span>            result[i][j]:
<span class="linenos">21</span>               0 4 8 12 16
<span class="linenos">22</span>               1 5 9 13 17
<span class="linenos">23</span>               2 6 10 14 18
<span class="linenos">24</span>               3 7 11 15 19
<span class="linenos">25</span>
<span class="linenos">26</span>   * &quot;crazy reverse&quot; row major (C) stride:
<span class="linenos">27</span>      stride[2] = { -5, -1 }
<span class="linenos">28</span>      offset[2] = { 4, 5 }
<span class="linenos">29</span>      for i:
<span class="linenos">30</span>         for j:
<span class="linenos">31</span>            result[i][j]:
<span class="linenos">32</span>               19 18 17 16 15
<span class="linenos">33</span>               14 13 12 11 10
<span class="linenos">34</span>               9 8 7 6 5
<span class="linenos">35</span>               4 3 2 1 0   
</pre></div>
</div>
</div>
<div class="compound">
<p class="rubric">Offset and Stride for 3D Data</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>  * raw data = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
<span class="linenos"> 2</span>         20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39
<span class="linenos"> 3</span>         40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59
<span class="linenos"> 4</span>      size[3] = { 3, 4, 5 }  // assume uniform overall array dimensions
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>   * row major (C) stride:
<span class="linenos"> 7</span>      stride[3] = { 20, 5, 1 }
<span class="linenos"> 8</span>      offset[3] = { 0, 0, 0 }
<span class="linenos"> 9</span>      for i:
<span class="linenos">10</span>         for j:
<span class="linenos">11</span>            for k:
<span class="linenos">12</span>               result[i][j][k]:
<span class="linenos">13</span>                  0 1 2 3 4
<span class="linenos">14</span>                  5 6 7 8 9
<span class="linenos">15</span>                  10 11 12 13 14
<span class="linenos">16</span>                  15 16 17 18 19
<span class="linenos">17</span>
<span class="linenos">18</span>                  20 21 22 23 24
<span class="linenos">19</span>                  25 26 27 28 29
<span class="linenos">20</span>                  30 31 32 33 34
<span class="linenos">21</span>                  35 36 37 38 39
<span class="linenos">22</span>
<span class="linenos">23</span>                  40 41 42 43 44
<span class="linenos">24</span>                  45 46 47 48 49
<span class="linenos">25</span>                  50 51 52 53 54
<span class="linenos">26</span>                  55 56 57 58 59
<span class="linenos">27</span>
<span class="linenos">28</span>   * column major (Fortran) stride:
<span class="linenos">29</span>      stride[3] = { 1, 3, 12 }
<span class="linenos">30</span>      offset[3] = { 0, 0, 0 }
<span class="linenos">31</span>      for i:
<span class="linenos">32</span>         for j:
<span class="linenos">33</span>            for k:
<span class="linenos">34</span>               result[i][j][k]:
<span class="linenos">35</span>                  0 12 24 36 48
<span class="linenos">36</span>                  3 15 27 39 51
<span class="linenos">37</span>                  6 18 30 42 54
<span class="linenos">38</span>                  9 21 33 45 57
<span class="linenos">39</span>
<span class="linenos">40</span>                  1 13 25 37 49
<span class="linenos">41</span>                  4 16 28 40 52
<span class="linenos">42</span>                  7 19 31 43 55
<span class="linenos">43</span>                  10 22 34 46 58
<span class="linenos">44</span>
<span class="linenos">45</span>                  2 14 26 38 50
<span class="linenos">46</span>                  5 17 29 41 53
<span class="linenos">47</span>                  8 20 32 44 56
<span class="linenos">48</span>                  11 23 35 47 59
</pre></div>
</div>
</div>
</section>
</section>
<section id="nexus-data-types">
<span id="design-datatypes"></span><h2>NeXus Data Types<a class="headerlink" href="#nexus-data-types" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>description</p></th>
<th class="head"><p>matching regular expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NX_INT(8|16|32|64)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>floating-point</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NX_FLOAT(32|64)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>array</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(\\[0-9\\])?</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid item name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">^[a-zA-Z0-9_]([a-zA-Z0-9_.]*[a-zA-Z0-9_])?$</span></code></p></td>
</tr>
<tr class="row-even"><td><p>valid class name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">^NX[A-Za-z0-9_]*$</span></code></p></td>
</tr>
</tbody>
</table>
<p>NeXus supports numeric data as either integer or floating-point
numbers.  A number follows that indicates the number of bits in the word.
The table above shows the regular expressions that
match the data type specifier.</p>
<dl class="simple" id="index-12">
<dt><strong>integers</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">NX_INT8</span></code>,
<code class="docutils literal notranslate"><span class="pre">NX_INT16</span></code>,
<code class="docutils literal notranslate"><span class="pre">NX_INT32</span></code>,
or
<code class="docutils literal notranslate"><span class="pre">NX_INT64</span></code></p>
</dd>
</dl>
<dl class="simple" id="index-13">
<dt><strong>floating-point numbers</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">NX_FLOAT32</span></code>
or
<code class="docutils literal notranslate"><span class="pre">NX_FLOAT64</span></code></p>
</dd>
</dl>
<dl class="simple" id="index-14">
<dt><strong>date / time stamps</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">NX_DATE_TIME</span></code> or  <code class="docutils literal notranslate"><span class="pre">ISO8601</span></code>:
Dates and times are specified using
ISO-8601 standard definitions.
Refer to <a class="reference internal" href="#design-dates-times"><span class="std std-ref">NeXus dates and times</span></a>.</p>
</dd>
</dl>
<span id="index-15"></span><dl id="index-16">
<dt><strong>strings</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">NX_CHAR</span></code>:
The preferred string representation is UTF-8.
Both fixed-length strings and variable-length strings are valid.
String arrays cannot be used where only a string is expected
(title, start_time, end_time, <code class="docutils literal notranslate"><span class="pre">NX_class</span></code> attribute,…).
Fields or attributes requiring the use of string arrays will be
clearly marked as such (like the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> attribute auxiliary_signals).</p>
<span class="target" id="index-19"><span id="index-18"></span><span id="index-17"></span></span></dd>
</dl>
<dl class="simple" id="index-20">
<dt><strong>binary data</strong></dt><dd><p>Binary data is to be written as <code class="docutils literal notranslate"><span class="pre">UINT8</span></code>.</p>
</dd>
</dl>
<dl class="simple" id="index-21">
<dt><strong>images</strong></dt><dd><p>Binary image data is to be written using <code class="docutils literal notranslate"><span class="pre">UINT8</span></code>, the same as binary data, but with an accompanying image mime-type.
If the data is text, the line terminator is <code class="docutils literal notranslate"><span class="pre">[CR][LF]</span></code>.</p>
</dd>
</dl>
<section id="nexus-dates-and-times">
<span id="design-dates-times"></span><h3>NeXus dates and times<a class="headerlink" href="#nexus-dates-and-times" title="Link to this heading">¶</a></h3>
<p id="index-22">NeXus  <span class="target" id="index-23"></span>dates and times
should be stored using the <a class="reference external" href="https://www.w3.org/TR/NOTE-datetime">ISO 8601</a> <a class="footnote-reference brackets" href="#id8" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>  format,
e.g. <code class="docutils literal notranslate"><span class="pre">1996-07-31T21:15:22+0600</span></code> (which includes
a time zone offset of <code class="docutils literal notranslate"><span class="pre">+0600</span></code>).
Note:  The time zone offset is always numeric or <code class="docutils literal notranslate"><span class="pre">Z</span></code> (which means UTC).
The standard also allows for time intervals in fractional seconds
with <em>1 or more digits of precision</em>.
This avoids confusion, e.g. between U.S. and European conventions,
and is appropriate for machine sorting.
It is recommended to add an explicit time zone,
otherwise the local time zone is assumed per ISO8601.
The norm is that if there is no time zone, it is assumed
local time, however, when a file moves from one country to
another it is undefined. If the local time zone is written,
the ambiguity is gone.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">5</a><span class="fn-bracket">]</span></span>
<p>ISO 8601: <a class="reference external" href="https://www.w3.org/TR/NOTE-datetime">https://www.w3.org/TR/NOTE-datetime</a></p>
</aside>
</aside>
<div class="compound">
<p class="rubric">strftime() format specifiers for ISO-8601 time</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>%Y-%m-%dT%H:%M:%S%z
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">T</span></code> appears literally in the string,
to indicate the beginning of the time element, as specified
in ISO 8601.  It is common to use a space in place of the
<code class="docutils literal notranslate"><span class="pre">T</span></code>, such as <code class="docutils literal notranslate"><span class="pre">1996-07-31</span> <span class="pre">21:15:22+0600</span></code>.
While human-readable (and later allowed in a relaxed revision
of the standard), compatibility with libraries supporting
the ISO 8601 standard is not
assured with this substitution.  The <code class="docutils literal notranslate"><span class="pre">strftime()</span></code>
format specifier for this is “<code class="docutils literal notranslate"><span class="pre">%Y-%m-%d</span> <span class="pre">%H:%M:%S%z</span></code>”.</p>
</div>
</section>
</section>
<section id="nexus-data-units">
<span id="design-units"></span><span id="index-24"></span><h2>NeXus Data Units<a class="headerlink" href="#nexus-data-units" title="Link to this heading">¶</a></h2>
<p>Given the plethora of possible applications of NeXus, it is difficult to
define units to use. Therefore, the general rule is that you are free to
store data in any unit you find fit. However, any field must have a
units attribute which describes the units. Wherever possible, SI units are
preferred. NeXus units are written as a string attribute (<code class="docutils literal notranslate"><span class="pre">NX_CHAR</span></code>)
and describe the engineering units. The string
should be appropriate for the value.
Values for the NeXus units must be specified in
a format compatible with <a class="reference external" href="http://www.unidata.ucar.edu/software/udunits">Unidata UDunits</a> <a class="footnote-reference brackets" href="#udunits" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>
Application definitions may specify units to be used for fields
using <span class="target" id="index-25"></span>an <code class="docutils literal notranslate"><span class="pre">enumeration</span></code>.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="udunits" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">6</a><span class="fn-bracket">]</span></span>
<p>The <span class="target" id="index-26"></span>UDunits
specification also includes instructions  for derived units.
At present, the contents of NeXus <code class="docutils literal notranslate"><span class="pre">units</span></code> attributes
are not validated in data files.</p>
</aside>
</aside>
</section>
<section id="storing-detectors">
<span id="rules-storingdetectors"></span><h2>Storing Detectors<a class="headerlink" href="#storing-detectors" title="Link to this heading">¶</a></h2>
<p>There are very different types of detectors out there. Storing their data
can be a challenge. As a general guide line: if the detector has some
well defined form, this should be reflected in the data file. A linear
detector becomes a linear array, a rectangular detector becomes an
array of size <code class="docutils literal notranslate"><span class="pre">xsize</span></code> times <code class="docutils literal notranslate"><span class="pre">ysize</span></code>.
Some detectors are so irregular that this
does not work. Then the detector data is stored as a linear array, with the
index being detector number till <code class="docutils literal notranslate"><span class="pre">ndet</span></code>. Such detectors must be accompanied
by further arrays of length <code class="docutils literal notranslate"><span class="pre">ndet</span></code> which give
<code class="docutils literal notranslate"><span class="pre">azimuthal_angle,</span> <span class="pre">polar_angle</span> <span class="pre">and</span> <span class="pre">distance</span></code> for each detector.</p>
<p>If data from a time of flight (TOF) instrument must be described, then the
TOF dimension becomes the last dimension, for example an area detector of
<code class="docutils literal notranslate"><span class="pre">xsize</span></code> <em>vs.</em> <code class="docutils literal notranslate"><span class="pre">ysize</span></code>
is stored with TOF as an array with dimensions
<code class="docutils literal notranslate"><span class="pre">xsize,</span> <span class="pre">ysize,</span>
<span class="pre">ntof</span></code>.</p>
</section>
<section id="monitors-are-special">
<span id="rules-storingdata-monitors"></span><h2>Monitors are Special<a class="headerlink" href="#monitors-are-special" title="Link to this heading">¶</a></h2>
<p><span class="target" id="index-27"></span>Monitors, detectors that measure the properties
of the experimental probe rather than the probe’s interaction with the
sample, have a special place in NeXus files. Monitors are crucial to normalize data.
To emphasize their role, monitors are not stored in the
<code class="docutils literal notranslate"><span class="pre">NXinstrument</span></code> hierarchy but on <code class="docutils literal notranslate"><span class="pre">NXentry</span></code> level
in their own groups as there might be multiple monitors. Of special
importance is the monitor in a group called <code class="docutils literal notranslate"><span class="pre">control</span></code>.
This is the main monitor against which the data has to be normalized.
This group also contains the counting control information,
i.e. counting mode, times, etc.</p>
<p>Monitor data may be multidimensional. Good examples are scan monitors
where a monitor value per scan point is expected or
time-of-flight monitors.</p>
</section>
<section id="find-the-plottable-data">
<span id="find-plottable-data"></span><span id="index-28"></span><h2>Find the plottable data<a class="headerlink" href="#find-the-plottable-data" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="motivations.html#simpleplotting"><span class="std std-ref">Simple plotting</span></a> is one of the motivations for the NeXus standard.
To implement <em>simple plotting</em>, a mechanism must exist to identify
the default data for visualization (plotting) in any NeXus data file.
Over its history the NIAC has agreed upon a method of applying metadata
to identify the default plottable data.  This metadata has always been
specified as HDF attributes.  With the evolution of the underlying file
formats and the NeXus data standard, the method to identify the default
plottable data has evolved, undergoing three distinct versions.</p>
<dl class="field-list simple">
<dt class="field-odd">version 1<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#design-findplottable-bydimnumber"><span class="std std-ref">Associating plottable data by dimension number using the axis attribute</span></a></p>
</dd>
<dt class="field-even">version 2<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#design-findplottable-byname"><span class="std std-ref">Associating plottable data by name using the axes attribute</span></a></p>
</dd>
<dt class="field-odd">version 3<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#design-findplottable-niac2014"><span class="std std-ref">Associating plottable data using attributes applied to the NXdata group</span></a></p>
</dd>
</dl>
<p>Consult the <a class="reference internal" href="introduction-napi.html#introduction-napi"><span class="std std-ref">NeXus API</span></a>
section, which describes the routines available to program these
operations. In the course of time, generic NeXus browsers will
provide this functionality automatically.</p>
<p>For programmers who may encounter NeXus data files written using
any of these methods, we present the algorithm for each method
to find the default plottable data.  It is recommended to start
with the most recent method, <a class="reference internal" href="#find-plottable-data-v3"><span class="std std-ref">Version 3</span></a>, first.</p>
<section id="version-3">
<span id="find-plottable-data-v3"></span><span id="index-31"></span><span id="index-30"></span><span id="index-29"></span><h3>Version 3<a class="headerlink" href="#version-3" title="Link to this heading">¶</a></h3>
<p>The third (current) method to identify the default
plottable data is as follows:</p>
<ol class="arabic">
<li><p>Start at the top level of the NeXus data file
(the <em>root</em> of the HDF5 hierarchy).</p></li>
<li><p>Pick the <span class="target" id="index-32"></span>default <a class="reference internal" href="classes/base_classes/NXentry.html#nxentry"><span class="std std-ref">NXentry</span></a> group.</p>
<p>If the <em>root</em> has an attribute <code class="docutils literal notranslate"><span class="pre">default</span></code>, the attribute’s value is the name of the
<code class="docutils literal notranslate"><span class="pre">NXentry</span></code> group to be used.
(The value of the <code class="docutils literal notranslate"><span class="pre">default</span></code> attribute <a class="reference internal" href="#validitemname"><span class="std std-ref">names</span></a> an
existing child of this group. The child group must itself be a NeXus group.)
If no <cite>default</cite> attribute exists, pick any
<code class="docutils literal notranslate"><span class="pre">NXentry</span></code> group.  This is trivial if there is only one <code class="docutils literal notranslate"><span class="pre">NXentry</span></code> group.</p>
<div class="compound">
<figure class="align-default" id="id16">
<span id="fig-flowchart-nxroot-default"></span><a class="reference internal image-reference" href="_images/flowchart-NXroot-default.png"><img alt="fig.flowchart-NXroot-default" src="_images/flowchart-NXroot-default.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: select the <code class="docutils literal notranslate"><span class="pre">NXentry</span></code> group</span><a class="headerlink" href="#id16" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</li>
<li><p>Pick the default <a class="reference internal" href="classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a> group.</p>
<p>Open the <code class="docutils literal notranslate"><span class="pre">NXentry</span></code> group selected above. If it has an attribute
<code class="docutils literal notranslate"><span class="pre">default</span></code>, the attribute’s value is the name of the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group to be used.
(The value of the <code class="docutils literal notranslate"><span class="pre">default</span></code> attribute <a class="reference internal" href="#validitemname"><span class="std std-ref">names</span></a> an
existing child of this group. The child group must itself be a NeXus group.)
If no <cite>default</cite> attribute exists, pick any <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group. This is trivial
if there is only one <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group.</p>
<div class="compound">
<figure class="align-default" id="id17">
<span id="fig-flowchart-nxentry-default"></span><a class="reference internal image-reference" href="_images/flowchart-NXentry-default.png"><img alt="fig.flowchart-NXentry-default" src="_images/flowchart-NXentry-default.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: select the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group</span><a class="headerlink" href="#id17" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</li>
</ol>
<ol class="arabic" id="index-33">
<li><p>Pick the default plottable field (the <em>signal</em> data).</p>
<p>Open the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group selected above. If it has a <code class="docutils literal notranslate"><span class="pre">signal</span></code> attribute,
the attribute’s value is the name of the field to be plotted.
(The value of the <code class="docutils literal notranslate"><span class="pre">signal</span></code> attribute <a class="reference internal" href="#validitemname"><span class="std std-ref">names</span></a> an
existing child of this group. The child group must itself be a NeXus field.)
If no <code class="docutils literal notranslate"><span class="pre">signal</span></code> attribute is present on the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code>
group, then proceed to try an <a class="reference internal" href="#find-plottable-data-v2"><span class="std std-ref">older NeXus
method</span></a> to find the default plottable data.</p>
<div class="compound">
<figure class="align-default" id="id18">
<span id="fig-flowchart-nxdata-signal"></span><a class="reference internal image-reference" href="_images/flowchart-NXdata-signal.png"><img alt="fig.flowchart-NXdata-signal" src="_images/flowchart-NXdata-signal.png" style="width: 90%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: select the <em>signal</em> data</span><a class="headerlink" href="#id18" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
<ol class="arabic">
<li><p>Pick the fields with the dimension scales (the <em>axes</em>).</p>
<p>If the same <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group has an attribute <code class="docutils literal notranslate"><span class="pre">axes</span></code>,
then its value is a string (<em>signal</em> data is 1-D) or
string array (<em>signal</em> data is 2-D or higher rank)
naming the field <strong>in this group</strong> to be used as
dimension scales of the default plottable data.
The number of values given must be equal to the
<em>rank</em> of the <em>signal</em> data.  These are the <em>abscissae</em>
of the plottable <em>signal</em> data.</p>
<p><em>If</em> no field is available to provide a dimension scale
for a given dimension, then a “<code class="docutils literal notranslate"><span class="pre">.</span></code>” will be used in that position.
In such cases, programmers are expected to use an integer
sequence starting from 0 for each position along that dimension.</p>
</li>
<li><p>Associate the dimension scales with each dimension of the plottable data.</p>
<p>For each field (its name is <em>AXISNAME</em>) in <code class="docutils literal notranslate"><span class="pre">axes</span></code> that
provides a dimension scale, there will be
an <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group attribute <code class="docutils literal notranslate"><span class="pre">AXISNAME_indices</span></code> which
value is an
.. integer or
integer array with value of the
dimensions of the <em>signal</em> data to which this dimension scale applies.</p>
<p>If no <code class="docutils literal notranslate"><span class="pre">AXISNAME_indices</span></code> attribute is provided, a programmer is encouraged
to make best efforts assuming the intent of this <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group
to provide a default plot.
The <code class="docutils literal notranslate"><span class="pre">AXISNAME_indices</span></code> attribute is only required when necessary to
resolve ambiguity.</p>
<p>It is possible there may be more than one <code class="docutils literal notranslate"><span class="pre">AXISNAME_indices</span></code> attribute
with the same value or values.  This indicates the possibilty of using
alternate abscissae along this (these) dimension(s).  The
field named in the <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute indicates the intention of
the data file writer as to which field should be used by default.</p>
</li>
</ol>
</li>
<li><p>Plot the <em>signal</em> data, given <em>axes</em> and <em>AXISNAME_indices</em>.</p></li>
</ol>
<p>When all the <code class="docutils literal notranslate"><span class="pre">default</span></code> and <code class="docutils literal notranslate"><span class="pre">signal</span></code> attributes are present, this
Python code example will identify directly the default plottable data
(assuming a <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function has been defined by some code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">group</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">hdf5_file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="k">while</span> <span class="s2">&quot;default&quot;</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
    <span class="n">child_group_name</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span>
    <span class="n">group</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="n">child_group_name</span><span class="p">]</span>

<span class="c1"># assumes group.attrs[&quot;NX_class&quot;] == &quot;NXdata&quot;</span>
<span class="n">signal_field_name</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="n">signal_field_name</span><span class="p">]</span>

<span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="version-2">
<span id="find-plottable-data-v2"></span><h3>Version 2<a class="headerlink" href="#version-2" title="Link to this heading">¶</a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Try this method for older NeXus data files and <a class="reference internal" href="#find-plottable-data-v3"><span class="std std-ref">Version 3</span></a> fails..</p>
</div>
<p>The second method to identify the default
plottable data is as follows:</p>
<ol class="arabic">
<li><p>Start at the top level of the NeXus data file.</p></li>
<li><p>Loop through the groups with class <code class="docutils literal notranslate"><span class="pre">NXentry</span></code>
until the next step succeeds.</p>
<div class="compound">
<figure class="align-default" id="id19">
<span id="fig-flowchart-v2-nxroot-default"></span><a class="reference internal image-reference" href="_images/flowchart-v2-NXroot-default.png"><img alt="fig.flowchart-v2-NXroot-default" src="_images/flowchart-v2-NXroot-default.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: pick a <code class="docutils literal notranslate"><span class="pre">NXentry</span></code> group</span><a class="headerlink" href="#id19" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</li>
<li><p>Open the NXentry group and loop through the subgroups
with class <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> until the next step succeeds.</p>
<div class="compound">
<figure class="align-default" id="id20">
<span id="fig-flowchart-v2-nxentry-default"></span><a class="reference internal image-reference" href="_images/flowchart-v2-NXentry-default.png"><img alt="fig.flowchart-v2-NXentry-default" src="_images/flowchart-v2-NXentry-default.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: pick a <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group</span><a class="headerlink" href="#id20" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</li>
<li><p>Open the NXdata group and loop through the fields for the one field
with attribute <code class="docutils literal notranslate"><span class="pre">signal=&quot;1&quot;</span></code>.
Note: There should be <em>only one</em> field that matches.</p>
<p>This is the default plottable data.</p>
<p>If there is no such <code class="docutils literal notranslate"><span class="pre">signal=&quot;1&quot;</span></code> field,
proceed to try an
<a class="reference internal" href="#find-plottable-data-v1"><span class="std std-ref">older NeXus method</span></a>
to find the default plottable data.</p>
<ol class="arabic simple">
<li><p>If this field has an attribute <code class="docutils literal notranslate"><span class="pre">axes</span></code>:</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute value contains a colon (or comma)
delimited list (in the C-order of the data array) with
the names of the
<span class="target" id="index-34"></span>dimension scales
associated with the plottable data.
Such as:  <code class="docutils literal notranslate"><span class="pre">axes=&quot;polar_angle:time_of_flight&quot;</span></code></p></li>
<li><p>Parse <code class="docutils literal notranslate"><span class="pre">axes</span></code> and open the fields to describe your
<span class="target" id="index-35"></span>dimension scales</p></li>
</ol>
</li>
<li><p>If this field has no attribute <code class="docutils literal notranslate"><span class="pre">axes</span></code>:</p>
<ol class="arabic simple">
<li><p>Search for fields with attributes <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>, <code class="docutils literal notranslate"><span class="pre">axis=2</span></code>, etc.</p></li>
<li><p>These are the fields describing your axis. There may be
several fields for any axis, i.e. there may be multiple
fields with the attribute <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>. Among them the
field with the attribute <code class="docutils literal notranslate"><span class="pre">primary=1</span></code> is the preferred one.
All others are alternative <span class="target" id="index-36"></span>dimension scales.</p></li>
</ol>
</li>
</ol>
</li>
<li><p>Having found the default plottable data and its dimension scales:
make the plot.</p>
<div class="compound">
<figure class="align-default" id="id21">
<span id="fig-flowchart-v2-nxdata-signal"></span><a class="reference internal image-reference" href="_images/flowchart-v2-NXdata-signal.png"><img alt="fig.flowchart-v2-NXdata-signal" src="_images/flowchart-v2-NXdata-signal.png" style="width: 98%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: select the <em>signal</em> data</span><a class="headerlink" href="#id21" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</li>
</ol>
</section>
<section id="version-1">
<span id="find-plottable-data-v1"></span><h3>Version 1<a class="headerlink" href="#version-1" title="Link to this heading">¶</a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Try this method for older NeXus data files.</p>
</div>
<p>The first method to identify the default
plottable data is as follows:</p>
<ol class="arabic">
<li><p>Open the first top level NeXus group with class
<code class="docutils literal notranslate"><span class="pre">NXentry</span></code>.</p>
<div class="compound">
<figure class="align-default" id="id22">
<span id="fig-flowchart-v1-nxroot-default"></span><a class="reference internal image-reference" href="_images/flowchart-v1-NXroot-default.png"><img alt="fig.flowchart-v1-NXroot-default" src="_images/flowchart-v1-NXroot-default.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: pick the first <code class="docutils literal notranslate"><span class="pre">NXentry</span></code> group</span><a class="headerlink" href="#id22" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</li>
<li><p>Open the first NeXus group with class
<code class="docutils literal notranslate"><span class="pre">NXdata</span></code>.</p>
<div class="compound">
<figure class="align-default" id="id23">
<span id="fig-flowchart-v1-nxentry-default"></span><a class="reference internal image-reference" href="_images/flowchart-v1-NXentry-default.png"><img alt="fig.flowchart-v1-NXentry-default" src="_images/flowchart-v1-NXentry-default.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: pick the first <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group</span><a class="headerlink" href="#id23" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</li>
<li><p>Loop through NeXus fields in this group searching for the item
with attribute
<code class="docutils literal notranslate"><span class="pre">signal=&quot;1&quot;</span></code>
indicating this field has the plottable data.</p></li>
<li><p>Search for the
one-dimensional NeXus fields with attribute <code class="docutils literal notranslate"><span class="pre">primary=1</span></code>.
These are the dimension scales to label
the axes of each dimension of the data.</p></li>
<li><p>Link each dimension scale
to the respective data dimension by
the <code class="docutils literal notranslate"><span class="pre">axis</span></code> attribute (<code class="docutils literal notranslate"><span class="pre">axis=1</span></code>, <code class="docutils literal notranslate"><span class="pre">axis=2</span></code>,
… up to the  <span class="target" id="index-37"></span>rank of the data).</p>
<div class="compound">
<figure class="align-default" id="id24">
<span id="fig-flowchart-v1-nxdata-signal"></span><a class="reference internal image-reference" href="_images/flowchart-v1-NXdata-signal.png"><img alt="fig.flowchart-v1-NXdata-signal" src="_images/flowchart-v1-NXdata-signal.png" style="width: 98%;" />
</a>
<figcaption>
<p><span class="caption-text">Find plottable data: select the <em>signal</em> data</span><a class="headerlink" href="#id24" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</li>
<li><p>If necessary, close this
<code class="docutils literal notranslate"><span class="pre">NXdata</span></code>
group, search the next <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group, repeating steps 3 to 5.</p></li>
<li><p>If necessary, close the
<code class="docutils literal notranslate"><span class="pre">NXentry</span></code>
group, search the next <code class="docutils literal notranslate"><span class="pre">NXentry</span></code> group, repeating steps 2 to 6.</p></li>
</ol>
</section>
</section>
<section id="associating-multi-dimensional-data-with-axis-data">
<span id="multi-dimensional-data"></span><span id="index-38"></span><h2>Associating Multi Dimensional Data with Axis Data<a class="headerlink" href="#associating-multi-dimensional-data-with-axis-data" title="Link to this heading">¶</a></h2>
<p>NeXus allows for storage of multi dimensional arrays of data.  It is this
data that presents the most challenge for description.  In most cases
it is not sufficient to just have the indices into the array as a label for
the dimensions of the data. Usually the information which physical value
corresponds to an index into a dimension of the multi dimensional data set.
To this purpose a means is needed to locate appropriate data arrays which describe
what each dimension of a multi dimensional data set actually corresponds too.
There is a standard HDF facility to do this: it is called
<span class="target" id="index-39"></span>dimension scales.
Unfortunately, when NeXus was first designed,
there was only one global namespace for dimension scales.
Thus NeXus had to devise its own scheme for locating axis data which is described
here. A side effect of the NeXus scheme is that it is possible to have multiple
mappings of a given dimension to physical data. For example, a TOF data set can have the TOF
dimension as raw TOF or as energy.</p>
<p>There are now three methods of <span class="target" id="index-40"></span>associating
each data dimension to its respective dimension scale.
Only the first method is recommended now, the other two (older methods) are now discouraged.</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#design-findplottable-niac2014"><span class="std std-ref">Associating plottable data using attributes applied to the NXdata group</span></a></p></li>
<li><p><a class="reference internal" href="#design-findplottable-byname"><span class="std std-ref">Associating plottable data by name using the axes attribute</span></a></p></li>
<li><p><a class="reference internal" href="#design-findplottable-bydimnumber"><span class="std std-ref">Associating plottable data by dimension number using the axis attribute</span></a></p></li>
</ol>
<p>The recommended method uses the <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute applied to the <a class="reference internal" href="classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a> group
to specify the names of each
<span class="target" id="index-41"></span>dimension scale.
A prerequisite is that the fields describing the axes of the plottable data
are stored together with the plottable data in the same NeXus group.
If this leads to data duplication, use <a class="reference internal" href="design.html#design-links"><span class="std std-ref">links</span></a>.</p>
<hr class="docutils" />
<section id="associating-plottable-data-using-attributes-applied-to-the-nxdata-group">
<span id="design-findplottable-niac2014"></span><h3>Associating plottable data using attributes applied to the <a class="reference internal" href="classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a> group<a class="headerlink" href="#associating-plottable-data-using-attributes-applied-to-the-nxdata-group" title="Link to this heading">¶</a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Recommended:
This is the “<em>NIAC2014</em>” method recommended for all new NeXus data files.</p>
</div>
<p>The default data to be plotted (and any associated axes)
is specified using attributes attached to the <a class="reference internal" href="classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a> group.</p>
<dl class="field-list">
<dt class="field-odd"><code class="docutils literal notranslate"><span class="pre">signal</span></code><span class="colon">:</span></dt>
<dd class="field-odd"><p>Defines the name of the default field <em>in the NXdata group</em>.
A field of this name <em>must</em> exist (either as field or link to field).</p>
<p>It is recommended to use this attribute
rather than adding a signal attribute to the field.  <a class="footnote-reference brackets" href="#id14" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a>
The procedure to identify the default data to be plotted is quite simple.
Given any NeXus data file, any <code class="docutils literal notranslate"><span class="pre">NXentry</span></code>, or any <code class="docutils literal notranslate"><span class="pre">NXdata</span></code>,
follow the chain as it is described from that point.
Specifically:</p>
<ul class="simple">
<li><p>The root of the NeXus file may have a <code class="docutils literal notranslate"><span class="pre">default</span></code>
attribute that names the default <a class="reference internal" href="classes/base_classes/NXentry.html#nxentry"><span class="std std-ref">NXentry</span></a> group.
This attribute may be omitted if there is only one NXentry group.
If a second NXentry group is later added, the <code class="docutils literal notranslate"><span class="pre">default</span></code> attribute
must be added then.</p></li>
<li><p>Every <a class="reference internal" href="classes/base_classes/NXentry.html#nxentry"><span class="std std-ref">NXentry</span></a> group may have a <code class="docutils literal notranslate"><span class="pre">default</span></code>
attribute that names the default <a class="reference internal" href="classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a> group.
This attribute may be omitted if there is only one NXdata group
or if no NXdata is present.
If a second NXdata group is later added, the <code class="docutils literal notranslate"><span class="pre">default</span></code> attribute
must be added then.</p></li>
<li><p>Every <a class="reference internal" href="classes/base_classes/NXdata.html#nxdata"><span class="std std-ref">NXdata</span></a> group will have a <code class="docutils literal notranslate"><span class="pre">signal</span></code>
attribute that names the field name to be plotted by default.
This attribute is required.</p></li>
</ul>
</dd>
<dt class="field-even"><code class="docutils literal notranslate"><span class="pre">axes</span></code><span class="colon">:</span></dt>
<dd class="field-even"><p>String array <a class="footnote-reference brackets" href="#aa" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> that defines the independent data fields used in
the default plot for all of the dimensions of the <em>signal</em> field.
One entry is provided for every dimension in the <em>signal</em> field.</p>
<p>The field(s) named as values (known as “axes”) of this attribute
<em>must</em> exist. An axis slice is specified using a field named
<code class="docutils literal notranslate"><span class="pre">AXISNAME_indices</span></code> as described below (where the text shown here
as <code class="docutils literal notranslate"><span class="pre">AXISNAME</span></code> is to be replaced by the actual field name).</p>
<p>When no default axis is available for a particular dimension
of the plottable data, use a “.” in that position.</p>
<p>See examples provided on the NeXus webpage (<a class="footnote-reference brackets" href="#axes" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a>).</p>
<p>If there are no axes at all (such as with a stack of images),
the axes attribute can be omitted.</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd"><code class="docutils literal notranslate"><span class="pre">AXISNAME_indices</span></code><span class="colon">:</span></dt>
<dd class="field-odd"><p>Each <code class="docutils literal notranslate"><span class="pre">AXISNAME_indices</span></code> attribute indicates the dependency
relationship of the <code class="docutils literal notranslate"><span class="pre">AXISNAME</span></code> field (where <code class="docutils literal notranslate"><span class="pre">AXISNAME</span></code>
is the name of a field that exists in this <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group)
with one or more dimensions of the plottable data.</p>
<p>Integer array <a class="footnote-reference brackets" href="#aa" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> that defines the indices of the <em>signal</em> field
(that field will be a multidimensional array)
which need to be used in the <code class="docutils literal notranslate"><span class="pre">AXISNAME</span></code> field in
order to reference the corresponding axis value.</p>
<p>The first index of an array is <code class="docutils literal notranslate"><span class="pre">0</span></code> (zero).</p>
<p>Here, <em>AXISNAME</em> is to be replaced by the name of each
field described in the <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute.
An example with 2-D data, <span class="math notranslate nohighlight">\(d(t,P)\)</span>, will illustrate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_2d</span><span class="p">:</span><span class="n">NXdata</span>
    <span class="nd">@signal</span><span class="o">=</span><span class="s2">&quot;data&quot;</span>
    <span class="nd">@axes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="s2">&quot;pressure&quot;</span><span class="p">]</span>
    <span class="nd">@time_indices</span><span class="o">=</span><span class="mi">0</span>
    <span class="nd">@pressure_indices</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">float</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span>
    <span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
<p>This attribute is to be provided in all situations.
However, if the indices attributes are missing
(such as for data files written before this specification),
file readers are encouraged to make their best efforts
to plot the data.
Thus the implementation of the
<code class="docutils literal notranslate"><span class="pre">AXISNAME_indices</span></code> attribute is based on the model of
“strict writer, liberal reader”.</p>
</dd>
</dl>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id14" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">7</a><span class="fn-bracket">]</span></span>
<p>Summary of the discussion at NIAC2014 to revise how to find default data:
<a class="reference external" href="https://www.nexusformat.org/2014_How_to_find_default_data.html">https://www.nexusformat.org/2014_How_to_find_default_data.html</a></p>
</aside>
<aside class="footnote brackets" id="aa" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id11">1</a>,<a role="doc-backlink" href="#id13">2</a>)</span>
<p>Note on array attributes:
Attributes potentially containing multiple values
(axes and _indices) are to be written as string or integer arrays,
to avoid string parsing in reading applications.</p>
</aside>
<aside class="footnote brackets" id="axes" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id12">1</a>,<a role="doc-backlink" href="#id15">2</a>)</span>
<p>NIAC2014 proposition: <a class="reference external" href="https://www.nexusformat.org/2014_axes_and_uncertainties.html">https://www.nexusformat.org/2014_axes_and_uncertainties.html</a></p>
</aside>
</aside>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h4>
<p>Several examples are provided to illustrate this method.
More examples are available in the NeXus webpage (<a class="footnote-reference brackets" href="#axes" id="id15" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a>).</p>
<div class="compound">
<p class="rubric">simple 1-D data example showing how to identify the default data (<em>counts</em> vs. <em>mr</em>)</p>
<p>In the first example, storage of a 1-D data set  (<em>counts</em> vs. <em>mr</em>) is described.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>datafile.hdf5:NeXus data file
<span class="linenos"> 2</span>  @default=&quot;entry&quot;
<span class="linenos"> 3</span>  entry:NXentry
<span class="linenos"> 4</span>    @default=&quot;data&quot;
<span class="linenos"> 5</span>    data:NXdata
<span class="linenos"> 6</span>      @signal=&quot;counts&quot;
<span class="linenos"> 7</span>      @axes=&quot;mr&quot;
<span class="linenos"> 8</span>      @mr_indices=0
<span class="linenos"> 9</span>      counts: float[100]  --&gt; the default dependent data
<span class="linenos">10</span>      mr: float[100]      --&gt; the default independent data
</pre></div>
</div>
</div>
<div class="compound">
<p class="rubric">2-D data example showing how to identify the default data and associated dimension scales</p>
<p>A 2-D data set, <em>data</em> as a function of <em>time</em> and <em>pressure</em> is described.
By default as indicated by the <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute,
<em>pressure</em> is to be used.
The <em>temperature</em> array is described as a substitute for <em>pressure</em>
(so it replaces dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> of <code class="docutils literal notranslate"><span class="pre">data</span></code> as indicated by the
<code class="docutils literal notranslate"><span class="pre">temperature_indices</span></code> attribute).</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>datafile.hdf5:NeXus data file
<span class="linenos"> 2</span>  @default=&quot;entry&quot;
<span class="linenos"> 3</span>  entry:NXentry
<span class="linenos"> 4</span>    @default=&quot;data_2d&quot;
<span class="linenos"> 5</span>    data_2d:NXdata
<span class="linenos"> 6</span>      @signal=&quot;data&quot;
<span class="linenos"> 7</span>      @axes=[&quot;time&quot;,&quot;pressure&quot;]
<span class="linenos"> 8</span>      @pressure_indices=1
<span class="linenos"> 9</span>      @temperature_indices=1
<span class="linenos">10</span>      @time_indices=0
<span class="linenos">11</span>      data: float[1000,20]
<span class="linenos">12</span>      pressure: float[20]
<span class="linenos">13</span>      temperature: float[20]
<span class="linenos">14</span>      time: float[1000]
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="associating-plottable-data-by-name-using-the-axes-attribute">
<span id="design-findplottable-byname"></span><h3>Associating plottable data by name using the <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute<a class="headerlink" href="#associating-plottable-data-by-name-using-the-axes-attribute" title="Link to this heading">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Discouraged:
See this method: <a class="reference internal" href="#design-findplottable-niac2014"><span class="std std-ref">Associating plottable data using attributes applied to the NXdata group</span></a>.</p>
</div>
<p>This method defines an attribute of the data field
<span class="target" id="index-42"></span>called <em>axes</em>.
The <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute contains the names of
each <span class="target" id="index-43"></span>dimension scale
as a colon (or comma) separated list in the order they appear in C.
For example:</p>
<div class="compound">
<p class="rubric">denoting axes by name</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>  data:NXdata
<span class="linenos">2</span>    time_of_flight = 1500.0 1502.0 1504.0 ...
<span class="linenos">3</span>    polar_angle = 15.0 15.6 16.2 ...
<span class="linenos">4</span>    some_other_angle = 0.0 0.0 2.0 ...
<span class="linenos">5</span>    data = 5 7 14 ...
<span class="linenos">6</span>      @axes = [&quot;polar_angle&quot;, &quot;time_of_flight&quot;]
<span class="linenos">7</span>      @signal = 1
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="associating-plottable-data-by-dimension-number-using-the-axis-attribute">
<span id="design-findplottable-bydimnumber"></span><h3>Associating plottable data by dimension number using the <code class="docutils literal notranslate"><span class="pre">axis</span></code> attribute<a class="headerlink" href="#associating-plottable-data-by-dimension-number-using-the-axis-attribute" title="Link to this heading">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Discouraged:
See this method: <a class="reference internal" href="#design-findplottable-byname"><span class="std std-ref">Associating plottable data by name using the axes attribute</span></a></p>
</div>
<p>The original method defines an attribute of each dimension
scale field <span class="target" id="index-44"></span>called <em>axis</em>.
It is an integer whose value is the number of
the dimension, in order of
<span class="target" id="index-45"></span>fastest varying dimension.
That is, if the array being stored is data with elements
<code class="docutils literal notranslate"><span class="pre">data[j][i]</span></code> in C and
<code class="docutils literal notranslate"><span class="pre">data(i,j)</span></code> in Fortran, where <code class="docutils literal notranslate"><span class="pre">i</span></code> is the
time-of-flight index and <code class="docutils literal notranslate"><span class="pre">j</span></code> is
the polar angle index, the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> <span class="target" id="index-46"></span>group
would contain:</p>
<div class="compound">
<p class="rubric">denoting axes by integer number</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>  data:NXdata
<span class="linenos"> 2</span>    time_of_flight = 1500.0 1502.0 1504.0 ...
<span class="linenos"> 3</span>      @axis = 1
<span class="linenos"> 4</span>      @primary = 1
<span class="linenos"> 5</span>    polar_angle = 15.0 15.6 16.2 ...
<span class="linenos"> 6</span>      @axis = 2
<span class="linenos"> 7</span>      @primary = 1
<span class="linenos"> 8</span>    some_other_angle = 0.0 0.0 2.0 ...
<span class="linenos"> 9</span>      @axis = 1
<span class="linenos">10</span>    data = 5 7 14 ...
<span class="linenos">11</span>      @signal = 1
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">axis</span></code> attribute must
be defined for each dimension scale.
The <code class="docutils literal notranslate"><span class="pre">primary</span></code> attribute is unique to this method.</p>
<p>There are limited circumstances in which more
than one <span class="target" id="index-47"></span>dimension scale
for the same data dimension can be included in the same <code class="docutils literal notranslate"><span class="pre">NXdata</span></code> group.
The most common is when the dimension scales are
the three components of an
<em>(hkl)</em> scan. In order to
handle this case, we have defined another attribute
of type integer called
<code class="docutils literal notranslate"><span class="pre">primary</span></code> whose value determines the order
in which the scale is expected to be chosen for <span class="target" id="index-48"></span>plotting, i.e.</p>
<ul class="simple">
<li><p>1st choice: <code class="docutils literal notranslate"><span class="pre">primary=1</span></code></p></li>
<li><p>2nd choice: <code class="docutils literal notranslate"><span class="pre">primary=2</span></code></p></li>
<li><p>etc.</p></li>
</ul>
<p>If there is more than one scale with the same value of the <code class="docutils literal notranslate"><span class="pre">axis</span></code> attribute, one
of them must have set <code class="docutils literal notranslate"><span class="pre">primary=1</span></code>. Defining the <code class="docutils literal notranslate"><span class="pre">primary</span></code>
attribute for the other scales is optional.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>The <code class="docutils literal notranslate"><span class="pre">primary</span></code> attribute can only be</dt><dd><p>used with the first method of defining</p>
</dd>
<dt><span class="target" id="index-49"></span>dimension scales</dt><dd><p>discussed above. In addition to
the <code class="docutils literal notranslate"><span class="pre">signal</span></code> data, this
group could contain a data set of the same  <span class="target" id="index-50"></span>rank
and dimensions called <code class="docutils literal notranslate"><span class="pre">errors</span></code>
containing the standard deviations of the data.</p>
</dd>
</dl>
</div>
</div></blockquote>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">1.2.3.2. Rules for Storing Data Items in NeXus Files</a><ul>
<li><a class="reference internal" href="#naming-conventions">Naming Conventions</a></li>
<li><a class="reference internal" href="#variants">Variants</a></li>
<li><a class="reference internal" href="#uncertainties-or-errors">Uncertainties or Errors</a></li>
<li><a class="reference internal" href="#nexus-array-storage-order">NeXus Array Storage Order</a><ul>
<li><a class="reference internal" href="#non-c-storage-order">Non C Storage Order</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nexus-data-types">NeXus Data Types</a><ul>
<li><a class="reference internal" href="#nexus-dates-and-times">NeXus dates and times</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nexus-data-units">NeXus Data Units</a></li>
<li><a class="reference internal" href="#storing-detectors">Storing Detectors</a></li>
<li><a class="reference internal" href="#monitors-are-special">Monitors are Special</a></li>
<li><a class="reference internal" href="#find-the-plottable-data">Find the plottable data</a><ul>
<li><a class="reference internal" href="#version-3">Version 3</a></li>
<li><a class="reference internal" href="#version-2">Version 2</a></li>
<li><a class="reference internal" href="#version-1">Version 1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#associating-multi-dimensional-data-with-axis-data">Associating Multi Dimensional Data with Axis Data</a><ul>
<li><a class="reference internal" href="#associating-plottable-data-using-attributes-applied-to-the-nxdata-group">Associating plottable data using attributes applied to the <span class="xref std std-ref">NXdata</span> group</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#associating-plottable-data-by-name-using-the-axes-attribute">Associating plottable data by name using the <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute</a></li>
<li><a class="reference internal" href="#associating-plottable-data-by-dimension-number-using-the-axis-attribute">Associating plottable data by dimension number using the <code class="docutils literal notranslate"><span class="pre">axis</span></code> attribute</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="rules.html"
                          title="previous chapter"><span class="section-number">1.2.3.1. </span>Rules for Structuring Information in NeXus Files</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="fileformat.html"
                          title="next chapter"><span class="section-number">1.2.3.3. </span>Physical File format</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <p>Have a Question? <a href="https://github.com/nexusformat/definitions/issues/new">Get help</a></p>
    <ul class="this-page-menu">
    <style>
		  .avatar-container {
		    display: flex;
		    align-items: center;
		  }
		
		  .avatar {
		    width: 32px;
		    height: 32px;
		    border-radius: 50%;
		    margin-right: 5px;
		  }
		</style>
		
    
    
		<div class="avatar-container">
      
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
<div id="google_search" style="display: none">
	<hr />
	<h3>Google search</h3>
	<form method="get" action="https://www.google.com/search">
		<table border="0" align="center" cellpadding="0">
			<tr>
				<td>
					<input type="text"   name="q" value="" />
				</td>
			</tr>
			<tr>
				<td align="center" style="font-size:75%">
					<input type="radio"  name="sitesearch" value="" />global
					<input type="radio"  name="sitesearch"
						value="manual.nexusformat.org" 
						checked />NeXus manual
					<input type="submit" value="Go" />
					<br />
				</td>
			</tr>
		</table>
	</form>                                
</div>
<script type="text/javascript">$('#google_search').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="fileformat.html" title="1.2.3.3. Physical File format"
             >next</a> |</li>
        <li class="right" >
          <a href="rules.html" title="1.2.3.1. Rules for Structuring Information in NeXus Files"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">nexus v2024.02 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="user_manual.html" ><span class="section-number">1. </span>NeXus: User Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="design.html" ><span class="section-number">1.2. </span>NeXus Design</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1.2.3.2. </span>Rules for Storing Data Items in NeXus Files</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="copyright.html">Copyright</a> 1996-2024, NIAC, https://www.nexusformat.org.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>